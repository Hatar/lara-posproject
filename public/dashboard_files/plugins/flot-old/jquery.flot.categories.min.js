(function($){var options={xaxis:{users:null},yaxis:{users:null}};function processRawData(plot,series,data,datapoints){var xusers=series.xaxis.options.mode=="users",yusers=series.yaxis.options.mode=="users";if(!(xusers||yusers))return;var format=datapoints.format;if(!format){var s=series;format=[];format.push({x:true,number:true,required:true});format.push({y:true,number:true,required:true});if(s.bars.show||s.lines.show&&s.lines.fill){var autoscale=!!(s.bars.show&&s.bars.zero||s.lines.show&&s.lines.zero);format.push({y:true,number:true,required:false,defaultValue:0,autoscale:autoscale});if(s.bars.horizontal){delete format[format.length-1].y;format[format.length-1].x=true}}datapoints.format=format}for(var m=0;m<format.length;++m){if(format[m].x&&xusers)format[m].number=false;if(format[m].y&&yusers)format[m].number=false}}function getNextIndex(users){var index=-1;for(var v in users)if(users[v]>index)index=users[v];return index+1}function usersTickGenerator(axis){var res=[];for(var label in axis.users){var v=axis.users[label];if(v>=axis.min&&v<=axis.max)res.push([v,label])}res.sort(function(a,b){return a[0]-b[0]});return res}function setupusersForAxis(series,axis,datapoints){if(series[axis].options.mode!="users")return;if(!series[axis].users){var c={},o=series[axis].options.users||{};if($.isArray(o)){for(var i=0;i<o.length;++i)c[o[i]]=i}else{for(var v in o)c[v]=o[v]}series[axis].users=c}if(!series[axis].options.ticks)series[axis].options.ticks=usersTickGenerator;transformPointsOnAxis(datapoints,axis,series[axis].users)}function transformPointsOnAxis(datapoints,axis,users){var points=datapoints.points,ps=datapoints.pointsize,format=datapoints.format,formatColumn=axis.charAt(0),index=getNextIndex(users);for(var i=0;i<points.length;i+=ps){if(points[i]==null)continue;for(var m=0;m<ps;++m){var val=points[i+m];if(val==null||!format[m][formatColumn])continue;if(!(val in users)){users[val]=index;++index}points[i+m]=users[val]}}}function processDatapoints(plot,series,datapoints){setupusersForAxis(series,"xaxis",datapoints);setupusersForAxis(series,"yaxis",datapoints)}function init(plot){plot.hooks.processRawData.push(processRawData);plot.hooks.processDatapoints.push(processDatapoints)}$.plot.plugins.push({init:init,options:options,name:"users",version:"1.0"})})(jQuery);